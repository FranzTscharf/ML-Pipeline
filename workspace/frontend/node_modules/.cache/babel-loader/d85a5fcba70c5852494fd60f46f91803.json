{"ast":null,"code":"var _jsxFileName = \"/Users/i504430/OneDrive - SAP SE/SAP/Masterarbeit/tensorflow/workspace/frontend/src/model_correction.jsx\";\nimport React, { Component } from 'react';\nimport * as d3 from \"d3\";\nimport * as UIkit from \"uikit\";\nimport Tesseract from 'tesseract.js';\nimport { createWorker } from 'tesseract.js';\nimport ExampleDocument from './example_document.jpg';\nimport { encode } from \"base-64\";\nconst styleObj = {\n  minHeight: 'calc(100vh)',\n  maxWidth: 'fit-content',\n  borderRight: '1.5px solid',\n  borderRightColor: '#b5b5b594'\n};\nconst styleObj2 = {\n  backgroundColor: '#f0506e',\n  width: '100%'\n};\nconst styleObj3 = {\n  float: 'right'\n};\nconst styleObj4 = {\n  marginRight: '5px'\n};\nconst styleObjSpinner = {\n  height: '20px',\n  width: '20px',\n  color: '#1e86f0'\n};\nconst styleObjInLine = {\n  display: 'block'\n};\nconst styleObjSpinnerDiv = {\n  display: 'none'\n};\n\nclass Model_correction extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: props.inputData\n    };\n  }\n\n  componentDidMount() {\n    var init = 0;\n    var convData = this.state.data;\n    var data = [\n      /*\n      {id: 1, x: 100, y: 200, width: 149, height: 50, label: \"Identification\"},\n      {id: 2, x: 100, y: 300, width: 149, height: 50, label: \"Customer\"},\n      {id: 3, x: 100, y: 400, width: 149, height: 50, label: \"Type\"}\n      */\n    ];\n    var MAP_HEIGHT = 2500;\n    var MAP_WIDTH = MAP_HEIGHT * Math.sqrt(2);\n    var MAX_TRANSLATE_X = MAP_WIDTH / 2;\n    var MIN_TRANSLATE_X = -MAX_TRANSLATE_X;\n    var MAX_TRANSLATE_Y = MAP_HEIGHT / 2;\n    var MIN_TRANSLATE_Y = -MAX_TRANSLATE_Y;\n    var MIN_RECT_WIDTH = 5;\n    var MIN_RECT_HEIGHT = 5;\n    var HANDLE_R = 5;\n    var HANDLE_R_ACTIVE = 12;\n    var wrapper = document.getElementById(\"svgWrapper\");\n    var height = wrapper.offsetHeight;\n    var width = wrapper.offsetWidth;\n    /*\n    var\n        inpX = document.getElementById(\"x\"),\n        inpY = document.getElementById(\"y\"),\n        inpWidth = document.getElementById(\"width\"),\n        inpHeight = document.getElementById(\"height\");\n    */\n\n    var svg = d3.select(\"#svgID\"); // for the background\n\n    svg.append(\"rect\").style(\"fill\", \"transparent\").attr(\"width\", \"100%\").attr(\"height\", \"100%\");\n    var g = svg.append(\"g\"); // if model is showing reload the position of the bounding boxes\n\n    var model = document.getElementById(\"modal-full-split\");\n    UIkit.util.on('#modal-full-split', 'show', function () {\n      checkElement(\"#svgID\").then(element => {\n        if (init == 0) {\n          fillData(element);\n          init = 1;\n        }\n      });\n    });\n\n    async function checkElement(selector) {\n      const querySelector = document.querySelector(selector);\n\n      while (querySelector < 1 && typeof querySelector !== 'undefined') {\n        await rafAsync();\n      }\n\n      return querySelector;\n    }\n\n    function rafAsync() {\n      return new Promise(resolve => {\n        requestAnimationFrame(resolve); //faster than set time out\n      });\n    }\n\n    function fillData(element = document.querySelector(\"#svgID\")) {\n      if (typeof convData !== 'undefined' || convData !== '') {\n        var drawObj = element; //document.querySelector(\"#svgID\");\n\n        var img = document.querySelector(\"#documentPicture\");\n        var box_id = 0;\n        var newData = [];\n        convData.forEach(function (x) {\n          var box_score = x[1];\n          var box_class = x[0];\n          var box_x = x[2] * drawObj.width.animVal.value / img.naturalWidth;\n          var box_y = x[3] * drawObj.height.animVal.value / img.naturalHeight;\n          var box_width = (x[4] - x[2]) * drawObj.width.animVal.value / img.naturalWidth;\n          var box_height = (x[5] - x[3]) * drawObj.height.animVal.value / img.naturalHeight;\n          newData.push({\n            id: box_id,\n            x: box_x,\n            y: box_y,\n            width: box_width,\n            height: box_height,\n            label: box_class,\n            score: box_score\n          });\n          box_id = box_id + 1;\n        });\n        data = newData;\n        update();\n      }\n    }\n\n    function resizerHover() {\n      var el = d3.select(this),\n          isEntering = d3.event.type === \"mouseenter\";\n      el.classed(\"hovering\", isEntering).attr(\"r\", isEntering || el.classed(\"resizing\") ? HANDLE_R_ACTIVE : HANDLE_R);\n    }\n\n    function rectResizeStartEnd() {\n      var el = d3.select(this),\n          isStarting = d3.event.type === \"start\";\n      d3.select(this).classed(\"resizing\", isStarting).attr(\"r\", isStarting || el.classed(\"hovering\") ? HANDLE_R_ACTIVE : HANDLE_R);\n    }\n\n    function rectResizing(d) {\n      //document.querySelector(\"#deleteIcon\").setAttribute(\"cx\",d.width)\n      var dragX = Math.max(Math.min(d3.event.x, MAX_TRANSLATE_X), MIN_TRANSLATE_X);\n      var dragY = Math.max(Math.min(d3.event.y, MAX_TRANSLATE_Y), MIN_TRANSLATE_Y);\n\n      if (d3.select(this).classed(\"topleft\")) {\n        var newWidth = Math.max(d.width + d.x - dragX, MIN_RECT_WIDTH);\n        d.x += d.width - newWidth;\n        d.width = newWidth;\n        var newHeight = Math.max(d.height + d.y - dragY, MIN_RECT_HEIGHT);\n        d.y += d.height - newHeight;\n        d.height = newHeight;\n      } else {\n        d.width = Math.max(dragX - d.x, MIN_RECT_WIDTH);\n        d.height = Math.max(dragY - d.y, MIN_RECT_HEIGHT);\n      }\n\n      update();\n    }\n\n    function rectMoveStartEnd(d) {\n      d3.select(this).classed(\"moving\", d3.event.type === \"start\");\n    }\n\n    function detectContent(d) {\n      console.log(d);\n      var drawObj = document.querySelector(\"#svgID\");\n      var img = document.getElementById(\"documentPicture\");\n      var canvas = document.createElement(\"CANVAS\");\n      var img_x = d.x / drawObj.width.animVal.value * img.naturalWidth;\n      var img_y = d.y / drawObj.height.animVal.value * img.naturalHeight;\n      var img_width = d.width / drawObj.width.animVal.value * img.naturalWidth;\n      var img_height = d.height / drawObj.height.animVal.value * img.naturalHeight;\n      console.log(img_x, img_y, img_width, img_height); //canvas.setAttribute(\"width\",\"300\");\n      //canvas.setAttribute(\"height\",\"500\");\n\n      canvas.setAttribute(\"width\", img_width);\n      canvas.setAttribute(\"height\", img_height); //document.body.appendChild(canvas);\n      //var canvas = document.getElementById('myCanvas');\n\n      var context = canvas.getContext('2d');\n      var imageObj = new Image();\n      imageObj.crossOrigin = \"Anonymous\";\n      imageObj.src = img.src;\n\n      imageObj.onload = function () {\n        // draw cropped image\n        var sourceX = img_x; //d.x; //x from element\n\n        var sourceY = img_y; //d.y; //y from element\n\n        var sourceWidth = img_width; //d.width; //Width from element\n\n        var sourceHeight = img_height; //d.height; //Height from element\n\n        var destWidth = sourceWidth;\n        var destHeight = sourceHeight;\n        var destX = 0;\n        var destY = 0;\n        context.drawImage(imageObj, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight);\n        Tesseract.recognize(canvas).progress(p => {\n          //console.log(p.progress);\n          try {\n            //show the spinner in the responsible text field\n            document.querySelector(\"#spinner_\" + d.label).style.display = '';\n          } catch (err) {\n            console.log(err);\n          }\n        }).then(r => {\n          //console.log(r.text);\n          try {\n            document.querySelector(\"#spinner_\" + d.label).style.display = 'none';\n            document.querySelector(\"#text_\" + d.label).value = r.text;\n          } catch (err) {\n            console.log(err);\n          }\n        });\n      };\n    }\n\n    function rectMoving(d) {\n      var dragX = Math.max(Math.min(d3.event.x, MAX_TRANSLATE_X - d.width), MIN_TRANSLATE_X);\n      var dragY = Math.max(Math.min(d3.event.y, MAX_TRANSLATE_Y - d.height), MIN_TRANSLATE_Y);\n      d.x = dragX;\n      d.y = dragY; //detectContent(d);\n\n      update();\n    }\n\n    function getAllData() {\n      var g = d3.select(\"#svgID\");\n      var data = g.selectAll(\"g.rectangle\").data();\n      return data;\n    }\n\n    function addRect(newRects) {\n      newRects.append(\"rect\").classed(\"bg\", true).attr(\"fill\", \"transparent\").attr(\"stroke\", \"#f0506e\").attr(\"stroke-width\", 1).call(d3.drag().container(g.node()).on(\"start end\", rectMoveStartEnd).on(\"drag\", rectMoving).on(\"end\", detectContent));\n      newRects.append(\"g\").classed(\"circles\", true).each(function (d) {\n        var circleG = d3.select(this);\n        var editCircle = circleG.append(\"circle\").classed(\"topright\", true).attr(\"id\", \"deleteIcon\").attr(\"cx\", d.width).attr(\"cy\", 0).attr(\"r\", HANDLE_R).on(\"mouseenter\", function (f) {\n          d3.select(this).style('fill', '#f0506e');\n          d3.select(this.parentNode).select(\"svg\").selectAll(\"path\").each(function (e, i) {\n            d3.select(this).attr(\"stroke\", \"white\");\n          });\n        }).on(\"mouseleave\", function (f) {\n          d3.select(this).style('fill', '#fff');\n          d3.select(this.parentNode).select(\"svg\").selectAll(\"path\").each(function (e, i) {\n            d3.select(this).attr(\"stroke\", \"#f0506e\");\n          });\n        }).on(\"click\", function (f) {\n          d3.select(this.parentNode.parentNode).remove();\n          data = d3.select(\"#svgID\").selectAll(\"g.rectangle\").data();\n          console.log(data); //alert(\"on click\" + d.className);\n        });\n        circleG.append(\"circle\").classed(\"topleft\", true).style('fill', \"grey\").style('fill-opacity', '0.1').style('cursor', 'move').style('stroke-dasharray', '5').style('stroke', 'grey').style('r', 10).attr(\"r\", HANDLE_R).on(\"mouseenter mouseleave\", resizerHover).on(\"mouseup\", detectContent).call(d3.drag().container(g.node()).subject(function () {\n          return {\n            x: d3.event.x,\n            y: d3.event.y\n          };\n        }).on(\"start end\", rectResizeStartEnd).on(\"drag\", rectResizing));\n        circleG.append(\"circle\").classed(\"bottomright\", true).style('fill', \"grey\").style('fill-opacity', '0.1').style('cursor', 'move').style('stroke-dasharray', '5').style('stroke', 'grey').style('r', 10).attr(\"r\", HANDLE_R).on(\"mouseenter mouseleave\", resizerHover).call(d3.drag().container(g.node()).subject(function () {\n          return {\n            x: d3.event.x,\n            y: d3.event.y\n          };\n        }).on(\"start end\", rectResizeStartEnd).on(\"end\", detectContent).on(\"drag\", rectResizing));\n        circleG.append(\"text\").attr(\"class\", \"labelText\").attr(\"dx\", 12).attr(\"dy\", -2).attr(\"font-size\", \"10px\").text(d.label);\n        var editIcon = circleG.append(\"svg\").attr(\"x\", d.width).attr(\"y\", -8).classed(\"toprightsvg\", true);\n        editIcon.append(\"path\").attr(\"stroke\", \"#f0506e\").attr(\"stroke-width\", \"1.06\").attr(\"d\", \"M16,16 L4,4\").attr(\"transform\", \"scale(0.8)\");\n        editIcon.append(\"path\").attr(\"stroke\", \"#f0506e\").attr(\"stroke-width\", \"1.06\").attr(\"d\", \"M16,4 L4,16\").attr(\"transform\", \"scale(0.8)\");\n      });\n    }\n\n    function onClickAdd(labelText) {\n      console.log(labelText);\n      document.querySelector(\"#dropdownClasses\").classList.remove(\"uk-open\");\n      data.push({\n        id: 12,\n        x: 100,\n        y: 200,\n        width: 150,\n        height: 150,\n        label: labelText\n      });\n      update();\n    }\n\n    function update() {\n      var rects = g.selectAll(\"g.rectangle\").data(data, function (d) {\n        return d;\n      });\n      rects.exit().remove();\n      var newRects = rects.enter().append(\"g\").classed(\"rectangle\", true);\n      addRect(newRects);\n      var allRects = newRects.merge(rects);\n      allRects.attr(\"transform\", function (d) {\n        return \"translate(\" + d.x + \",\" + d.y + \")\";\n      });\n      allRects.select(\"rect.bg\").attr(\"height\", function (d) {\n        return d.height;\n      }).attr(\"width\", function (d) {\n        return d.width;\n      });\n      allRects.select(\"circle.bottomright\").attr(\"cx\", function (d) {\n        return d.width;\n      }).attr(\"cy\", function (d) {\n        return d.height;\n      });\n      allRects.select(\"circle.topright\").attr(\"cx\", function (d) {\n        return d.width;\n      });\n      allRects.select(\"svg.toprightsvg\").attr(\"x\", function (d) {\n        return d.width - 8.1;\n      });\n      /*\n      inpX.value = data[0].x;\n      inpY.value = data[0].y;\n      inpWidth.value = data[0].width;\n      inpHeight.value = data[0].height;\n      */\n      //write data to current array of rectangels\n      //console.log(data);\n    }\n\n    function controlChange() {\n      data[0][this.id] = +this.value;\n      update();\n    }\n\n    function initElements() {\n      //draw elements\n      update(); //enable dropdown and hide it of the add menue bar item\n\n      UIkit.dropdown(document.querySelector(\"#dropdownClasses\")).hide(); //add listeners to add new bpunding boxes\n\n      document.querySelectorAll('[id^=\"add\"]').forEach(function (e) {\n        e.addEventListener(\"click\", function (d) {\n          onClickAdd(e.innerText);\n        });\n      });\n      document.getElementById(\"button_reset\").addEventListener(\"click\", function (e) {\n        fillData();\n      });\n    }\n\n    initElements();\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      id: \"modal-full-split\",\n      className: \"uk-modal-full uk-modal\",\n      \"uk-modal\": \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 454\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"uk-modal-close-full uk-icon uk-close\",\n      type: \"button\",\n      \"uk-close\": \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 455\n      },\n      __self: this\n    }, React.createElement(\"svg\", {\n      width: \"14\",\n      height: \"14\",\n      viewBox: \"0 0 14 14\",\n      xmlns: \"http://www.w3.org/2000/svg\",\n      \"data-svg\": \"close-icon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 456\n      },\n      __self: this\n    }, React.createElement(\"line\", {\n      fill: \"none\",\n      stroke: \"#000\",\n      strokeWidth: \"1.1\",\n      x1: \"1\",\n      y1: \"1\",\n      x2: \"13\",\n      y2: \"13\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 458\n      },\n      __self: this\n    }), React.createElement(\"line\", {\n      fill: \"none\",\n      stroke: \"#000\",\n      strokeWidth: \"1.1\",\n      x1: \"13\",\n      y1: \"1\",\n      x2: \"1\",\n      y2: \"13\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 459\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"uk-modal-dialog\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 462\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-grid-collapse uk-child-width-1-2@s uk-flex-middle uk-grid\",\n      \"uk-grid\": \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 463\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-background-cover uk-first-column\",\n      style: styleObj,\n      \"uk-height-viewport\": \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 464\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-button-group\",\n      style: styleObj2,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 467\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"uk-button uk-button-danger\",\n      id: \"button_reset\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 468\n      },\n      __self: this\n    }, \"Reset\"), React.createElement(\"div\", {\n      className: \"uk-inline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 469\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"uk-button uk-button-danger\",\n      type: \"button\",\n      \"aria-expanded\": \"false\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 470\n      },\n      __self: this\n    }, \"Add\"), React.createElement(\"div\", {\n      className: \"uk-dropdown\",\n      id: \"dropdownClasses\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 471\n      },\n      __self: this\n    }, React.createElement(\"ul\", {\n      className: \"uk-nav uk-dropdown-nav\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 472\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      className: \"uk-nav-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 473\n      },\n      __self: this\n    }, \"Classes\"), React.createElement(\"li\", {\n      className: \"uk-nav-divider\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 474\n      },\n      __self: this\n    }), React.createElement(\"li\", {\n      id: \"add_id\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 475\n      },\n      __self: this\n    }, \"identification\")), React.createElement(\"li\", {\n      id: \"add_type\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 476\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 476\n      },\n      __self: this\n    }, \"type\")), React.createElement(\"li\", {\n      id: \"add_customer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 477\n      },\n      __self: this\n    }, \"customer\")), React.createElement(\"li\", {\n      id: \"add_content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 478\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 478\n      },\n      __self: this\n    }, \"content\")), React.createElement(\"li\", {\n      id: \"add_header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 479\n      },\n      __self: this\n    }, \"header\")))))), React.createElement(\"div\", {\n      className: \"uk-vertical-align-middle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 484\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"img-overlay-wrap\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 485\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      id: \"documentPicture\",\n      src: ExampleDocument,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486\n      },\n      __self: this\n    }), React.createElement(\"input\", {\n      type: \"hidden\",\n      id: \"imgId\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 488\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      id: \"svgWrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 489\n      },\n      __self: this\n    }, React.createElement(\"svg\", {\n      id: \"svgID\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 490\n      },\n      __self: this\n    })))), React.createElement(\"fieldset\", {\n      id: \"controls\",\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 494\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 495\n      },\n      __self: this\n    }, \"x:\", React.createElement(\"input\", {\n      type: \"text\",\n      id: \"x\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 495\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 496\n      },\n      __self: this\n    }, \"y:\", React.createElement(\"input\", {\n      type: \"text\",\n      id: \"y\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 496\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497\n      },\n      __self: this\n    }, \"width:\", React.createElement(\"input\", {\n      type: \"text\",\n      id: \"width\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 497\n      },\n      __self: this\n    })), React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 498\n      },\n      __self: this\n    }, \"height:\", React.createElement(\"input\", {\n      type: \"text\",\n      id: \"height\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 498\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"uk-padding-large\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 503\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 504\n      },\n      __self: this\n    }, \"Dokument-Tagging\"), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 505\n      },\n      __self: this\n    }, \"Verschieben Sie die Rechtecke \\xFCber die Bereiche des Dokuments, die f\\xFCr das Tagging genutzt werden sollen. Die Abschnitte k\\xF6nnen gel\\xF6scht oder neu hinzugef\\xFCgt werden.\"), React.createElement(\"form\", {\n      className: \"uk-form-stacked\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 506\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-margin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 508\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"uk-form-label\",\n      htmlFor: \"text_Identification\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 509\n      },\n      __self: this\n    }, \"Identifikation:\"), React.createElement(\"div\", {\n      className: \"uk-form-controls\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 510\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-inline\",\n      style: styleObjInLine,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 511\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-form-icon uk-form-icon-flip uk-icon\",\n      id: \"spinner_identification\",\n      style: styleObjSpinnerDiv,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 512\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"uk-margin-small-right uk-icon uk-spinner\",\n      \"uk-spinner\": \"ratio: 3\",\n      style: styleObjSpinner,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 513\n      },\n      __self: this\n    })), React.createElement(\"input\", {\n      className: \"uk-input\",\n      id: \"text_identification\",\n      type: \"text\",\n      placeholder: \"Auftragsnummer, FIN, ...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 515\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"uk-margin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 520\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"uk-form-label\",\n      htmlFor: \"text_Type\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 521\n      },\n      __self: this\n    }, \"Type:\"), React.createElement(\"div\", {\n      className: \"uk-form-controls\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 522\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-inline\",\n      style: styleObjInLine,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 523\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-form-icon uk-form-icon-flip uk-icon\",\n      id: \"spinner_type\",\n      style: styleObjSpinnerDiv,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 524\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"uk-margin-small-right uk-icon uk-spinner\",\n      \"uk-spinner\": \"ratio: 3\",\n      style: styleObjSpinner,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 525\n      },\n      __self: this\n    })), React.createElement(\"input\", {\n      className: \"uk-input\",\n      id: \"text_type\",\n      type: \"text\",\n      placeholder: \"Bestellung PKW, Zahlungsu\\u0308bersicht, ...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 527\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"uk-margin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 532\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"uk-form-label\",\n      htmlFor: \"text_Customer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 533\n      },\n      __self: this\n    }, \"Customer:\"), React.createElement(\"div\", {\n      className: \"uk-form-controls\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 534\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-inline\",\n      style: styleObjInLine,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 535\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-form-icon uk-form-icon-flip uk-icon\",\n      id: \"spinner_customer\",\n      style: styleObjSpinnerDiv,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 536\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"uk-margin-small-right uk-icon uk-spinner\",\n      \"uk-spinner\": \"ratio: 3\",\n      style: styleObjSpinner,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 537\n      },\n      __self: this\n    })), React.createElement(\"textarea\", {\n      className: \"uk-textarea\",\n      id: \"text_customer\",\n      rows: \"2\",\n      placeholder: \"Herr. Max Mustermann Dorfstr. 11 10119 Berlin \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 539\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      className: \"uk-margin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 547\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      className: \"uk-form-label\",\n      htmlFor: \"form-h-textarea-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 548\n      },\n      __self: this\n    }, \"Content:\"), React.createElement(\"div\", {\n      className: \"uk-form-controls\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 549\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-inline\",\n      style: styleObjInLine,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 550\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"uk-form-icon uk-form-icon-flip uk-icon\",\n      id: \"spinner_content\",\n      style: styleObjSpinnerDiv,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 551\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"uk-margin-small-right uk-icon uk-spinner\",\n      \"uk-spinner\": \"ratio: 3\",\n      style: styleObjSpinner,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 552\n      },\n      __self: this\n    })), React.createElement(\"textarea\", {\n      className: \"uk-textarea\",\n      id: \"text_content\",\n      rows: \"2\",\n      placeholder: \"Ihre Bestellung \\xFCber einen PKW ist eingeganen und ...\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 554\n      },\n      __self: this\n    })))), React.createElement(\"p\", {\n      className: \"uk-margin uk-position-relative uk-position-right\",\n      style: styleObj3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 559\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"uk-button uk-button-default\",\n      style: styleObj4,\n      id: \"button_cancel\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 560\n      },\n      __self: this\n    }, \"Abbrechen\"), React.createElement(\"button\", {\n      className: \"uk-button uk-button-primary\",\n      id: \"button_okay\",\n      onClick: handleFeedback,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 561\n      },\n      __self: this\n    }, \"Okay\"))))))));\n\n    function handleFeedback(e) {\n      e.preventDefault();\n      var drawObj = document.querySelector(\"#svgID\");\n      var img = document.querySelector(\"#documentPicture\");\n      var filename = document.querySelector(\"#imgId\").value;\n      var dataParse = d3.select(\"#svgID\").selectAll(\"g.rectangle\").data();\n      dataParse.forEach(function (d) {\n        d.imgWidth = img.naturalWidth;\n        d.imgHeight = img.naturalHeight;\n        d.filename = filename;\n        d.xmin = d.x / drawObj.width.animVal.value * img.naturalWidth;\n        d.ymin = d.y / drawObj.height.animVal.value * img.naturalHeight;\n        d.xmax = d.xmin + d.width / drawObj.width.animVal.value * img.naturalWidth;\n        d.ymax = d.ymin + d.height / drawObj.height.animVal.value * img.naturalHeight;\n      });\n      console.log(dataParse);\n      let formData = new FormData();\n      formData.append('json', JSON.stringify(dataParse));\n      fetch(process.env.REACT_APP_API_GATEWAY_URL + \"gateway/feedback\", {\n        method: 'post',\n        body: formData\n      }).then(res => res.json()).then(result => {\n        console.log(result);\n        var init = 0;\n        pushTagsToSAP(); //hide the model to correkt the bounding boxes because the user is done editing\n\n        UIkit.modal(document.getElementById(\"modal-full-split\")).hide();\n      }, error => {\n        UIkit.notification({\n          message: 'Saving of feedback failed!',\n          status: 'danger',\n          pos: 'top-right',\n          timeout: 5000\n        });\n        console.error(error);\n      });\n    }\n\n    function pushTagsToSAP() {\n      var filename = document.querySelector(\"#imgId\").value;\n      var img_path = process.env.REACT_APP_API_GATEWAY_URL + \"tmp/\" + filename;\n      var myHeaders = new Headers();\n      myHeaders.append(\"Content-Type\", \"application/json\");\n      var username = \"MLAAS_FRONTEND_USER\";\n      var password = \"NotUseMe4AnyThing&Else2\";\n      var authString = username + ':' + password;\n      myHeaders.append(\"Authorization\", \"Basic \" + btoa(authString));\n      var raw = JSON.stringify({\n        \"FILENAME\": filename\n      });\n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: raw,\n        redirect: 'follow'\n      };\n      fetch(\"https://hanadbaide3tx1cjvc299.hana.ondemand.com/BCA3/I504430/service.xsodata/MLAAS\", requestOptions).then(response => response.text()).then(result => console.log(result)).catch(error => console.log('error', error));\n    }\n  }\n\n}\n\nexport default Model_correction;","map":{"version":3,"sources":["/Users/i504430/OneDrive - SAP SE/SAP/Masterarbeit/tensorflow/workspace/frontend/src/model_correction.jsx"],"names":["React","Component","d3","UIkit","Tesseract","createWorker","ExampleDocument","encode","styleObj","minHeight","maxWidth","borderRight","borderRightColor","styleObj2","backgroundColor","width","styleObj3","float","styleObj4","marginRight","styleObjSpinner","height","color","styleObjInLine","display","styleObjSpinnerDiv","Model_correction","constructor","props","state","data","inputData","componentDidMount","init","convData","MAP_HEIGHT","MAP_WIDTH","Math","sqrt","MAX_TRANSLATE_X","MIN_TRANSLATE_X","MAX_TRANSLATE_Y","MIN_TRANSLATE_Y","MIN_RECT_WIDTH","MIN_RECT_HEIGHT","HANDLE_R","HANDLE_R_ACTIVE","wrapper","document","getElementById","offsetHeight","offsetWidth","svg","select","append","style","attr","g","model","util","on","checkElement","then","element","fillData","selector","querySelector","rafAsync","Promise","resolve","requestAnimationFrame","drawObj","img","box_id","newData","forEach","x","box_score","box_class","box_x","animVal","value","naturalWidth","box_y","naturalHeight","box_width","box_height","push","id","y","label","score","update","resizerHover","el","isEntering","event","type","classed","rectResizeStartEnd","isStarting","rectResizing","d","dragX","max","min","dragY","newWidth","newHeight","rectMoveStartEnd","detectContent","console","log","canvas","createElement","img_x","img_y","img_width","img_height","setAttribute","context","getContext","imageObj","Image","crossOrigin","src","onload","sourceX","sourceY","sourceWidth","sourceHeight","destWidth","destHeight","destX","destY","drawImage","recognize","progress","p","err","r","text","rectMoving","getAllData","selectAll","addRect","newRects","call","drag","container","node","each","circleG","editCircle","f","parentNode","e","i","remove","subject","editIcon","onClickAdd","labelText","classList","rects","exit","enter","allRects","merge","controlChange","initElements","dropdown","hide","querySelectorAll","addEventListener","innerText","render","handleFeedback","preventDefault","filename","dataParse","imgWidth","imgHeight","xmin","ymin","xmax","ymax","formData","FormData","JSON","stringify","fetch","process","env","REACT_APP_API_GATEWAY_URL","method","body","res","json","result","pushTagsToSAP","modal","error","notification","message","status","pos","timeout","img_path","myHeaders","Headers","username","password","authString","btoa","raw","requestOptions","headers","redirect","response","catch"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport * as d3 from \"d3\";\nimport * as UIkit from \"uikit\";\nimport Tesseract from 'tesseract.js';\nimport { createWorker } from 'tesseract.js';\nimport ExampleDocument from './example_document.jpg';\nimport { encode } from \"base-64\";\n\n\nconst styleObj = {\n    minHeight: 'calc(100vh)',\n    maxWidth: 'fit-content',\n    borderRight: '1.5px solid',\n    borderRightColor: '#b5b5b594'\n};\n\nconst styleObj2 = {\n    backgroundColor: '#f0506e',\n    width: '100%'\n};\nconst styleObj3 = {\n    float: 'right'\n};\nconst styleObj4 = {\n    marginRight: '5px'\n};\n\nconst styleObjSpinner = {\n    height: '20px',\n    width: '20px',\n    color: '#1e86f0'\n};\nconst styleObjInLine = {\n    display: 'block'\n};\nconst styleObjSpinnerDiv = {\n    display: 'none'\n};\nclass Model_correction extends React.Component {\n    constructor(props){\n        super(props);\n        this.state = {\n            data: props.inputData,\n        };\n    }\n    componentDidMount() {\n        var init = 0;\n        var convData = this.state.data;\n        var data = [\n            /*\n            {id: 1, x: 100, y: 200, width: 149, height: 50, label: \"Identification\"},\n            {id: 2, x: 100, y: 300, width: 149, height: 50, label: \"Customer\"},\n            {id: 3, x: 100, y: 400, width: 149, height: 50, label: \"Type\"}\n            */\n        ];\n        var MAP_HEIGHT = 2500;\n        var MAP_WIDTH = MAP_HEIGHT * Math.sqrt(2);\n\n        var MAX_TRANSLATE_X = MAP_WIDTH / 2;\n        var MIN_TRANSLATE_X = -MAX_TRANSLATE_X;\n\n        var MAX_TRANSLATE_Y = MAP_HEIGHT / 2;\n        var MIN_TRANSLATE_Y = -MAX_TRANSLATE_Y;\n\n        var MIN_RECT_WIDTH = 5;\n        var MIN_RECT_HEIGHT = 5;\n\n        var HANDLE_R = 5;\n        var HANDLE_R_ACTIVE = 12;\n\n        var wrapper = document.getElementById(\"svgWrapper\");\n\n        var height = wrapper.offsetHeight;\n        var width = wrapper.offsetWidth;\n\n        /*\n        var\n            inpX = document.getElementById(\"x\"),\n            inpY = document.getElementById(\"y\"),\n            inpWidth = document.getElementById(\"width\"),\n            inpHeight = document.getElementById(\"height\");\n        */\n        var svg = d3.select(\"#svgID\");\n\n        // for the background\n        svg.append(\"rect\")\n            .style(\"fill\", \"transparent\")\n            .attr(\"width\", \"100%\")\n            .attr(\"height\", \"100%\");\n\n        var g = svg.append(\"g\");\n\n        // if model is showing reload the position of the bounding boxes\n        var model = document.getElementById(\"modal-full-split\");\n        UIkit.util.on('#modal-full-split', 'show', function () {\n            checkElement(\"#svgID\").then((element) => {\n                if (init == 0) {\n                    fillData(element);\n                    init = 1;\n                }\n            });\n        });\n        async function checkElement(selector) {\n            const querySelector = document.querySelector(selector);\n            while ((querySelector < 1) && (typeof querySelector !== 'undefined')) {\n                await rafAsync()\n            }\n            return querySelector;\n        }\n        function rafAsync() {\n            return new Promise(resolve => {\n                requestAnimationFrame(resolve); //faster than set time out\n            });\n        }\n        function fillData(element = document.querySelector(\"#svgID\")) {\n            if ((typeof convData !== 'undefined') || (convData !== '')) {\n                var drawObj = element;  //document.querySelector(\"#svgID\");\n                var img = document.querySelector(\"#documentPicture\");\n                var box_id = 0;\n                var newData = [];\n                convData.forEach(function (x) {\n                    var box_score = x[1];\n                    var box_class = x[0];\n                    var box_x = (x[2] * drawObj.width.animVal.value) / img.naturalWidth;\n                    var box_y = (x[3] * drawObj.height.animVal.value) / img.naturalHeight;\n                    var box_width = ((x[4] - x[2]) * drawObj.width.animVal.value) / img.naturalWidth;\n                    var box_height = ((x[5] - x[3]) * drawObj.height.animVal.value) / img.naturalHeight;\n                    newData.push({id: box_id, x: box_x, y: box_y, width: box_width, height: box_height, label: box_class, score: box_score});\n                    box_id = box_id + 1;\n                });\n                data = newData;\n                update();\n            }\n        }\n        function resizerHover() {\n            var el = d3.select(this), isEntering = d3.event.type === \"mouseenter\";\n            el\n                .classed(\"hovering\", isEntering)\n                .attr(\n                    \"r\",\n                    isEntering || el.classed(\"resizing\") ?\n                        HANDLE_R_ACTIVE : HANDLE_R\n                );\n        }\n\n        function rectResizeStartEnd() {\n            var el = d3.select(this), isStarting = d3.event.type === \"start\";\n            d3.select(this)\n                .classed(\"resizing\", isStarting)\n                .attr(\n                    \"r\",\n                    isStarting || el.classed(\"hovering\") ?\n                        HANDLE_R_ACTIVE : HANDLE_R\n                );\n        }\n\n        function rectResizing(d) {\n\n            //document.querySelector(\"#deleteIcon\").setAttribute(\"cx\",d.width)\n            var dragX = Math.max(\n                Math.min(d3.event.x, MAX_TRANSLATE_X),\n                MIN_TRANSLATE_X\n            );\n\n            var dragY = Math.max(\n                Math.min(d3.event.y, MAX_TRANSLATE_Y),\n                MIN_TRANSLATE_Y\n            );\n\n            if (d3.select(this).classed(\"topleft\")) {\n\n                var newWidth = Math.max(d.width + d.x - dragX, MIN_RECT_WIDTH);\n\n                d.x += d.width - newWidth;\n                d.width = newWidth;\n\n                var newHeight = Math.max(d.height + d.y - dragY, MIN_RECT_HEIGHT);\n\n                d.y += d.height - newHeight;\n                d.height = newHeight;\n\n            } else {\n\n                d.width = Math.max(dragX - d.x, MIN_RECT_WIDTH);\n                d.height = Math.max(dragY - d.y, MIN_RECT_HEIGHT);\n\n            }\n\n            update();\n        }\n\n        function rectMoveStartEnd(d) {\n            d3.select(this).classed(\"moving\", d3.event.type === \"start\");\n        }\n        function detectContent(d){\n            console.log(d);\n            var drawObj = document.querySelector(\"#svgID\");\n            var img = document.getElementById(\"documentPicture\");\n            var canvas = document.createElement(\"CANVAS\");\n            var img_x = (d.x / drawObj.width.animVal.value) * img.naturalWidth;\n            var img_y = (d.y / drawObj.height.animVal.value) * img.naturalHeight;\n            var img_width = (d.width / drawObj.width.animVal.value) * img.naturalWidth;\n            var img_height = (d.height / drawObj.height.animVal.value) * img.naturalHeight;\n            console.log(img_x, img_y, img_width, img_height);\n            //canvas.setAttribute(\"width\",\"300\");\n            //canvas.setAttribute(\"height\",\"500\");\n            canvas.setAttribute(\"width\",img_width);\n            canvas.setAttribute(\"height\",img_height);\n            //document.body.appendChild(canvas);\n            //var canvas = document.getElementById('myCanvas');\n            var context = canvas.getContext('2d');\n            var imageObj = new Image();\n            imageObj.crossOrigin = \"Anonymous\";\n            imageObj.src = img.src;\n            imageObj.onload = function() {\n                // draw cropped image\n                var sourceX = img_x;//d.x; //x from element\n                var sourceY = img_y;//d.y; //y from element\n                var sourceWidth = img_width;//d.width; //Width from element\n                var sourceHeight = img_height;//d.height; //Height from element\n                var destWidth = sourceWidth;\n                var destHeight = sourceHeight;\n                var destX = 0;\n                var destY = 0;\n                context.drawImage(imageObj, sourceX, sourceY, sourceWidth, sourceHeight, destX, destY, destWidth, destHeight);\n                Tesseract.recognize(canvas).progress((p) => {\n                    //console.log(p.progress);\n                    try {\n                        //show the spinner in the responsible text field\n                        document.querySelector(\"#spinner_\" + d.label).style.display = '';\n                    } catch(err) {\n                        console.log(err);\n                    }\n                }).then((r) => {\n                    //console.log(r.text);\n                    try{\n                        document.querySelector(\"#spinner_\" + d.label).style.display = 'none';\n                        document.querySelector(\"#text_\" + d.label).value = r.text;\n                    } catch(err){\n                        console.log(err);\n                    }\n                })\n            };\n        }\n\n        function rectMoving(d) {\n\n            var dragX = Math.max(\n                Math.min(d3.event.x, MAX_TRANSLATE_X - d.width),\n                MIN_TRANSLATE_X\n            );\n\n            var dragY = Math.max(\n                Math.min(d3.event.y, MAX_TRANSLATE_Y - d.height),\n                MIN_TRANSLATE_Y\n            );\n\n            d.x = dragX;\n            d.y = dragY;\n            //detectContent(d);\n            update();\n        }\n        function getAllData(){\n            var g = d3.select(\"#svgID\");\n            var data = g.selectAll(\"g.rectangle\").data();\n            return data;\n        }\n\n        function addRect(newRects){\n\n            newRects.append(\"rect\")\n                .classed(\"bg\", true)\n                .attr(\"fill\", \"transparent\")\n                .attr(\"stroke\", \"#f0506e\")\n                .attr(\"stroke-width\", 1)\n                .call(d3.drag()\n                    .container(g.node())\n                    .on(\"start end\", rectMoveStartEnd)\n                    .on(\"drag\", rectMoving)\n                    .on(\"end\", detectContent)\n                );\n\n            newRects.append(\"g\").classed(\"circles\", true).each(function (d) {\n                var circleG = d3.select(this);\n                var editCircle = circleG.append(\"circle\")\n                    .classed(\"topright\", true)\n                    .attr(\"id\", \"deleteIcon\")\n                    .attr(\"cx\", d.width)\n                    .attr(\"cy\", 0)\n                    .attr(\"r\", HANDLE_R)\n                    .on(\"mouseenter\", function(f){\n                        d3.select(this).style('fill', '#f0506e');\n                        d3.select(this.parentNode).select(\"svg\").selectAll(\"path\").each(function(e,i) {\n                            d3.select(this).attr(\"stroke\",\"white\");\n                        });\n                    })\n                    .on(\"mouseleave\", function(f){\n                        d3.select(this).style('fill', '#fff');\n                        d3.select(this.parentNode).select(\"svg\").selectAll(\"path\").each(function(e,i) {\n                            d3.select(this).attr(\"stroke\",\"#f0506e\");\n                        });\n                    })\n                    .on(\"click\", function(f) {\n                        d3.select(this.parentNode.parentNode).remove();\n                        data = d3.select(\"#svgID\").selectAll(\"g.rectangle\").data();\n                        console.log(data);\n                        //alert(\"on click\" + d.className);\n                    });\n\n                circleG.append(\"circle\")\n                    .classed(\"topleft\", true)\n                    .style('fill', \"grey\")\n                    .style('fill-opacity', '0.1')\n                    .style('cursor', 'move')\n                    .style('stroke-dasharray','5')\n                    .style('stroke', 'grey')\n                    .style('r', 10)\n                    .attr(\"r\", HANDLE_R)\n                    .on(\"mouseenter mouseleave\", resizerHover)\n                    .on(\"mouseup\", detectContent)\n                    .call(d3.drag()\n                        .container(g.node())\n                        .subject(function () {\n                            return {x: d3.event.x, y: d3.event.y};\n                        })\n                        .on(\"start end\", rectResizeStartEnd)\n                        .on(\"drag\", rectResizing)\n                    );\n\n                circleG\n                    .append(\"circle\")\n                    .classed(\"bottomright\", true)\n                    .style('fill', \"grey\")\n                    .style('fill-opacity', '0.1')\n                    .style('cursor', 'move')\n                    .style('stroke-dasharray','5')\n                    .style('stroke', 'grey')\n                    .style('r', 10)\n                    .attr(\"r\", HANDLE_R)\n                    .on(\"mouseenter mouseleave\", resizerHover)\n                    .call(d3.drag()\n                        .container(g.node())\n                        .subject(function () {\n                            return {x: d3.event.x, y: d3.event.y};\n                        })\n                        .on(\"start end\", rectResizeStartEnd)\n                        .on(\"end\", detectContent)\n                        .on(\"drag\", rectResizing)\n                    );\n                circleG\n                    .append(\"text\")\n                    .attr(\"class\", \"labelText\")\n                    .attr(\"dx\", 12)\n                    .attr(\"dy\", -2)\n                    .attr(\"font-size\", \"10px\")\n                    .text(d.label);\n                var editIcon = circleG.append(\"svg\").attr(\"x\", d.width).attr(\"y\", -8).classed(\"toprightsvg\", true);\n                editIcon.append(\"path\").attr(\"stroke\", \"#f0506e\").attr(\"stroke-width\",\"1.06\").attr(\"d\",\"M16,16 L4,4\").attr(\"transform\", \"scale(0.8)\");\n                editIcon.append(\"path\").attr(\"stroke\", \"#f0506e\").attr(\"stroke-width\",\"1.06\").attr(\"d\",\"M16,4 L4,16\").attr(\"transform\", \"scale(0.8)\");\n            });\n        }\n\n        function onClickAdd(labelText){\n            console.log(labelText);\n            document.querySelector(\"#dropdownClasses\").classList.remove(\"uk-open\");\n            data.push({id: 12, x: 100, y: 200, width: 150, height: 150, label: labelText});\n            update();\n        }\n        function update() {\n            var rects = g.selectAll(\"g.rectangle\").data(data, function (d) {\n                return d;\n            });\n\n            rects.exit().remove();\n\n            var newRects = rects.enter().append(\"g\").classed(\"rectangle\", true);\n            addRect(newRects);\n\n\n            var allRects = newRects.merge(rects);\n\n            allRects\n                .attr(\"transform\", function (d) {\n                    return \"translate(\" + d.x + \",\" + d.y + \")\";\n                });\n\n            allRects\n                .select(\"rect.bg\")\n                .attr(\"height\", function (d) {\n                    return d.height;\n                })\n                .attr(\"width\", function (d) {\n                    return d.width;\n                });\n\n\n            allRects\n                .select(\"circle.bottomright\")\n                .attr(\"cx\", function (d) {\n                    return d.width;\n                })\n                .attr(\"cy\", function (d) {\n                    return d.height;\n                });\n            allRects\n                .select(\"circle.topright\")\n                .attr(\"cx\", function (d) {\n                    return d.width;\n                });\n            allRects\n                .select(\"svg.toprightsvg\")\n                .attr(\"x\", function (d) {\n                    return d.width -8.1;\n                });\n\n            /*\n            inpX.value = data[0].x;\n            inpY.value = data[0].y;\n            inpWidth.value = data[0].width;\n            inpHeight.value = data[0].height;\n            */\n            //write data to current array of rectangels\n            //console.log(data);\n        }\n\n        function controlChange() {\n            data[0][this.id] = +this.value;\n            update();\n        }\n        function initElements(){\n            //draw elements\n            update();\n            //enable dropdown and hide it of the add menue bar item\n            UIkit.dropdown(document.querySelector(\"#dropdownClasses\")).hide();\n            //add listeners to add new bpunding boxes\n            document.querySelectorAll('[id^=\"add\"]').forEach(function (e) {\n                e.addEventListener(\"click\", function (d) {\n                    onClickAdd(e.innerText);\n                });\n            });\n            document.getElementById(\"button_reset\").addEventListener(\"click\",function (e) {\n                fillData();\n            });\n\n        }\n\n        initElements();\n\n    }\n\n    render() {\n          return (\n            <div>\n                <div id=\"modal-full-split\" className=\"uk-modal-full uk-modal\" uk-modal=\"\">\n                    <button className=\"uk-modal-close-full uk-icon uk-close\" type=\"button\" uk-close=\"\">\n                        <svg width=\"14\" height=\"14\" viewBox=\"0 0 14 14\" xmlns=\"http://www.w3.org/2000/svg\"\n                             data-svg=\"close-icon\">\n                            <line fill=\"none\" stroke=\"#000\" strokeWidth=\"1.1\" x1=\"1\" y1=\"1\" x2=\"13\" y2=\"13\"></line>\n                            <line fill=\"none\" stroke=\"#000\" strokeWidth=\"1.1\" x1=\"13\" y1=\"1\" x2=\"1\" y2=\"13\"></line>\n                        </svg>\n                    </button>\n                    <div className=\"uk-modal-dialog\">\n                        <div className=\"uk-grid-collapse uk-child-width-1-2@s uk-flex-middle uk-grid\" uk-grid=\"\">\n                            <div className=\"uk-background-cover uk-first-column\"\n                                 style={styleObj}\n                                 uk-height-viewport=\"\">\n                                <div className=\"uk-button-group\" style={styleObj2}>\n                                    <button className=\"uk-button uk-button-danger\" id=\"button_reset\">Reset</button>\n                                    <div className=\"uk-inline\">\n                                        <button className=\"uk-button uk-button-danger\" type=\"button\" aria-expanded=\"false\">Add</button>\n                                        <div className=\"uk-dropdown\" id=\"dropdownClasses\">\n                                            <ul className=\"uk-nav uk-dropdown-nav\">\n                                                <li className=\"uk-nav-header\">Classes</li>\n                                                <li className=\"uk-nav-divider\"></li>\n                                                    <li id=\"add_id\"><a>identification</a></li>\n                                                    <li id=\"add_type\"><a>type</a></li>\n                                                    <li id=\"add_customer\"><a>customer</a></li>\n                                                    <li id=\"add_content\"><a>content</a></li>\n                                                    <li id=\"add_header\"><a>header</a></li>\n                                            </ul>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"uk-vertical-align-middle\">\n                                    <div className=\"img-overlay-wrap\">\n                                        <img id=\"documentPicture\"\n                                               src={ExampleDocument}></img>\n                                        <input type=\"hidden\" id=\"imgId\"></input>\n                                        <div id=\"svgWrapper\">\n                                            <svg id=\"svgID\"></svg>\n                                        </div>\n                                    </div>\n                                </div>\n                                <fieldset id=\"controls\" hidden={true}>\n                                    <label>x:<input type=\"text\" id=\"x\"/></label>\n                                    <label>y:<input type=\"text\" id=\"y\"/></label>\n                                    <label>width:<input type=\"text\" id=\"width\"/></label>\n                                    <label>height:<input type=\"text\" id=\"height\"/></label>\n                                </fieldset>\n\n\n                            </div>\n                            <div className=\"uk-padding-large\">\n                                <h1>Dokument-Tagging</h1>\n                                <p>Verschieben Sie die Rechtecke über die Bereiche des Dokuments, die für das Tagging genutzt werden sollen. Die Abschnitte können gelöscht oder neu hinzugefügt werden.</p>\n                                <form className=\"uk-form-stacked\">\n\n                                    <div className=\"uk-margin\">\n                                        <label className=\"uk-form-label\" htmlFor=\"text_Identification\">Identifikation:</label>\n                                        <div className=\"uk-form-controls\">\n                                            <div className=\"uk-inline\" style={styleObjInLine}>\n                                                <div className=\"uk-form-icon uk-form-icon-flip uk-icon\" id=\"spinner_identification\" style={styleObjSpinnerDiv}>\n                                                     <span className=\"uk-margin-small-right uk-icon uk-spinner\" uk-spinner=\"ratio: 3\" style={styleObjSpinner}></span>\n                                                </div>\n                                                <input className=\"uk-input\" id=\"text_identification\" type=\"text\"\n                                                       placeholder=\"Auftragsnummer, FIN, ...\"/>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div className=\"uk-margin\">\n                                        <label className=\"uk-form-label\" htmlFor=\"text_Type\">Type:</label>\n                                        <div className=\"uk-form-controls\">\n                                            <div className=\"uk-inline\" style={styleObjInLine}>\n                                                <div className=\"uk-form-icon uk-form-icon-flip uk-icon\" id=\"spinner_type\" style={styleObjSpinnerDiv}>\n                                                    <span className=\"uk-margin-small-right uk-icon uk-spinner\" uk-spinner=\"ratio: 3\" style={styleObjSpinner}></span>\n                                                </div>\n                                                <input className=\"uk-input\" id=\"text_type\" type=\"text\"\n                                                       placeholder=\"Bestellung PKW, Zahlungsübersicht, ...\"/>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div className=\"uk-margin\">\n                                        <label className=\"uk-form-label\" htmlFor=\"text_Customer\">Customer:</label>\n                                        <div className=\"uk-form-controls\">\n                                            <div className=\"uk-inline\" style={styleObjInLine}>\n                                                <div className=\"uk-form-icon uk-form-icon-flip uk-icon\" id=\"spinner_customer\" style={styleObjSpinnerDiv}>\n                                                    <span className=\"uk-margin-small-right uk-icon uk-spinner\" uk-spinner=\"ratio: 3\" style={styleObjSpinner}></span>\n                                                </div>\n                                                <textarea className=\"uk-textarea\" id=\"text_customer\"\n                                                          rows=\"2\" placeholder=\"Herr. Max Mustermann\n                                                          Dorfstr. 11\n                                                          10119 Berlin\n                                                          \"></textarea>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div className=\"uk-margin\">\n                                        <label className=\"uk-form-label\" htmlFor=\"form-h-textarea-content\">Content:</label>\n                                        <div className=\"uk-form-controls\">\n                                            <div className=\"uk-inline\" style={styleObjInLine}>\n                                                <div className=\"uk-form-icon uk-form-icon-flip uk-icon\" id=\"spinner_content\" style={styleObjSpinnerDiv}>\n                                                    <span className=\"uk-margin-small-right uk-icon uk-spinner\" uk-spinner=\"ratio: 3\" style={styleObjSpinner}></span>\n                                                </div>\n                                                <textarea className=\"uk-textarea\" id=\"text_content\"\n                                                          rows=\"2\" placeholder=\"Ihre Bestellung über einen PKW ist eingeganen und ...\"></textarea>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <p className=\"uk-margin uk-position-relative uk-position-right\" style={styleObj3}>\n                                        <button className=\"uk-button uk-button-default\" style={styleObj4} id=\"button_cancel\">Abbrechen</button>\n                                        <button className=\"uk-button uk-button-primary\" id=\"button_okay\" onClick={handleFeedback}>Okay</button>\n                                    </p>\n                                </form>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n        );\n        function handleFeedback(e) {\n            e.preventDefault();\n            var drawObj = document.querySelector(\"#svgID\");\n            var img = document.querySelector(\"#documentPicture\");\n            var filename = document.querySelector(\"#imgId\").value;\n            var dataParse = d3.select(\"#svgID\").selectAll(\"g.rectangle\").data();\n            dataParse.forEach(function(d){\n                d.imgWidth = img.naturalWidth;\n                d.imgHeight = img.naturalHeight;\n                d.filename = filename;\n                d.xmin = (d.x / drawObj.width.animVal.value) * img.naturalWidth;\n                d.ymin = (d.y / drawObj.height.animVal.value) * img.naturalHeight;\n                d.xmax = d.xmin + ((d.width / drawObj.width.animVal.value) * img.naturalWidth);\n                d.ymax = d.ymin + ((d.height / drawObj.height.animVal.value) * img.naturalHeight);\n            });\n            console.log(dataParse);\n            let formData = new FormData();\n            formData.append('json', JSON.stringify(dataParse));\n            fetch(process.env.REACT_APP_API_GATEWAY_URL + \"gateway/feedback\",{method: 'post',body: formData})\n                .then(res => res.json())\n                .then((result) => {\n                    console.log(result);\n                    var init = 0;\n                    pushTagsToSAP();\n                    //hide the model to correkt the bounding boxes because the user is done editing\n                    UIkit.modal(document.getElementById(\"modal-full-split\")).hide();\n                    },(error) => {\n                        UIkit.notification({message: 'Saving of feedback failed!', status: 'danger', pos: 'top-right', timeout: 5000});\n                        console.error(error);\n                        });\n\n        }\n        function pushTagsToSAP(){\n            var filename = document.querySelector(\"#imgId\").value;\n            var img_path = process.env.REACT_APP_API_GATEWAY_URL + \"tmp/\" + filename;\n            var myHeaders = new Headers();\n            myHeaders.append(\"Content-Type\", \"application/json\");\n            var username = \"MLAAS_FRONTEND_USER\";\n            var password = \"NotUseMe4AnyThing&Else2\";\n            var authString = username+':'+password;\n            myHeaders.append(\"Authorization\", \"Basic \"+btoa(authString));\n            var raw = JSON.stringify({\n                \"FILENAME\":filename\n            });\n            var requestOptions = {\n                method: 'POST',\n                headers: myHeaders,\n                body: raw,\n                redirect: 'follow'\n            };\n            fetch(\"https://hanadbaide3tx1cjvc299.hana.ondemand.com/BCA3/I504430/service.xsodata/MLAAS\", requestOptions)\n                .then(response => response.text())\n                .then(result => console.log(result))\n                .catch(error => console.log('error', error));\n        }\n    }\n}\n\n\nexport default Model_correction;"]},"metadata":{},"sourceType":"module"}